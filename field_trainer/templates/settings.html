{% extends "base.html" %}
{% block title %}Settings - Field Trainer{% endblock %}
{% block content %}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h1><i class="bi bi-gear"></i> System Settings</h1>
    <div>
        <button id="reset-btn" class="btn btn-outline-danger me-2">
            <i class="bi bi-arrow-counterclockwise"></i> Reset to Defaults
        </button>
        <a href="/dashboard" class="btn btn-outline-secondary">
            <i class="bi bi-arrow-left"></i> Back to Dashboard
        </a>
    </div>
</div>

<!-- Display & Units Section -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-display"></i> Display & Units</h5>
    </div>
    <div class="card-body">
        <div class="row align-items-center">
            <div class="col-auto">
                <label class="form-label fw-bold mb-0">Distance Unit:</label>
            </div>
            <div class="col-auto">
                <div class="d-flex gap-3">
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="distance_unit" id="unit_yards" value="yards">
                        <label class="form-check-label" for="unit_yards">Yards</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="distance_unit" id="unit_meters" value="meters">
                        <label class="form-check-label" for="unit_meters">Meters</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="distance_unit" id="unit_feet" value="feet">
                        <label class="form-check-label" for="unit_feet">Feet</label>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Audio Settings Section -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-volume-up"></i> Audio Settings</h5>
    </div>
    <div class="card-body">
        <div class="mb-3">
            <label class="form-label fw-bold">Voice Gender</label>
            <div class="d-flex gap-4">
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="voice_gender" id="voice_male" value="male">
                    <label class="form-check-label" for="voice_male">Male</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="voice_gender" id="voice_female" value="female">
                    <label class="form-check-label" for="voice_female">Female</label>
                </div>
            </div>
        </div>

        <div class="mb-3">
            <label for="system_volume" class="form-label fw-bold">System Volume: <span id="volume-display">60</span>%</label>
            <div style="width: 33%;">
                <input type="range" class="form-range" min="0" max="100" step="5" id="system_volume">
            </div>
            <small class="form-text text-muted"><i class="bi bi-info-circle"></i> Volume slider affects Device 0 (Start) only. Remote devices use their local volume settings.</small>
        </div>

        <div class="mb-3">
            <label class="form-label fw-bold">Test Audio Playback</label>
            <div class="row g-2">
                <div class="col-md-4">
                    <label for="test_device" class="form-label">Device</label>
                    <select class="form-select" id="test_device">
                        <option value="ALL">ALL (Sequential)</option>
                        <option value="192.168.99.100">Start</option>
                        <option value="192.168.99.101">Cone 1</option>
                        <option value="192.168.99.102">Cone 2</option>
                        <option value="192.168.99.103">Cone 3</option>
                        <option value="192.168.99.104">Cone 4</option>
                        <option value="192.168.99.105">Cone 5</option>
                    </select>
                </div>
                <div class="col-md-8">
                    <label for="test_audio_file" class="form-label">Audio File</label>
                    <div class="input-group">
                        <select class="form-select" id="test_audio_file">
                            <option value="">-- Select Audio File --</option>
                        </select>
                        <button class="btn btn-outline-primary" type="button" id="play-audio-btn" title="Play on selected device">
                            <i class="bi bi-play-fill"></i> Play
                        </button>
                    </div>
                </div>
            </div>
            <small class="form-text text-muted">Test audio playback on any device. Device status will be checked before playing.</small>
        </div>

        <div class="mb-3">
            <label for="ready_audio_file" class="form-label fw-bold">Ready Notification Sound</label>
            <select class="form-select" id="ready_audio_file">
                <option value="">-- Select Audio File --</option>
            </select>
            <small class="form-text text-muted">Audio file played when system is ready for athlete</small>
        </div>
    </div>
</div>

<!-- Timing Defaults Section -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-clock"></i> Timing Defaults</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="min_travel_time" class="form-label fw-bold">Minimum Travel Time (seconds)</label>
                <input type="number" class="form-control" id="min_travel_time" min="0.1" step="0.1">
                <small class="form-text text-muted">Minimum expected time between devices</small>
            </div>
            <div class="col-md-6 mb-3">
                <label for="max_travel_time" class="form-label fw-bold">Maximum Travel Time (seconds)</label>
                <input type="number" class="form-control" id="max_travel_time" min="1" step="1">
                <small class="form-text text-muted">Maximum expected time between devices</small>
            </div>
        </div>
        <small class="form-text text-muted"><i class="bi bi-info-circle"></i> Note: Action-specific timing will be available in a future update</small>
    </div>
</div>

<!-- LED Settings Section -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-lightbulb"></i> LED Settings</h5>
    </div>
    <div class="card-body">
        <div class="mb-3">
            <label class="form-label fw-bold">Test LED</label>
            <div class="row g-2">
                <div class="col-md-4">
                    <label for="test_led_device" class="form-label">Device</label>
                    <select class="form-select" id="test_led_device">
                        <option value="ALL">ALL</option>
                        <option value="192.168.99.100">Start</option>
                        <option value="192.168.99.101">Cone 1</option>
                        <option value="192.168.99.102">Cone 2</option>
                        <option value="192.168.99.103">Cone 3</option>
                        <option value="192.168.99.104">Cone 4</option>
                        <option value="192.168.99.105">Cone 5</option>
                    </select>
                </div>
                <div class="col-md-4">
                    <label for="test_led_color" class="form-label">LED Color</label>
                    <select class="form-select" id="test_led_color">
                        <option value="orange">Orange</option>
                        <option value="blue">Blue</option>
                        <option value="green">Green</option>
                        <option value="yellow">Yellow</option>
                        <option value="red">Red</option>
                    </select>
                </div>
                <div class="col-md-4 d-flex align-items-end">
                    <button class="btn btn-outline-primary w-100" type="button" id="test-led-btn" title="Test LED on selected device">
                        <i class="bi bi-lightbulb"></i> Test LED
                    </button>
                </div>
            </div>
            <small class="form-text text-muted">Test will flash selected device LEDs for 5 seconds</small>
        </div>

        <div class="mb-3">
            <label for="ready_led_color" class="form-label fw-bold">Ready LED Color (Default)</label>
            <div style="width: 33%;">
                <select class="form-select" id="ready_led_color">
                    <option value="orange">Orange</option>
                    <option value="blue">Blue</option>
                    <option value="green">Green</option>
                    <option value="yellow">Yellow</option>
                    <option value="red">Red</option>
                </select>
            </div>
            <small class="form-text text-muted">Default LED color when ready</small>
        </div>
    </div>
</div>

<!-- Network Configuration Section -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-wifi"></i> Network Configuration</h5>
    </div>
    <div class="card-body">
        <div class="alert alert-info mb-3">
            <i class="bi bi-info-circle"></i>
            <strong>Current Network:</strong> <span id="current-ssid">Loading...</span>
        </div>

        <div class="alert alert-warning">
            <i class="bi bi-exclamation-triangle"></i>
            <strong>Warning:</strong> Changing WiFi settings may disconnect the system. Only modify if you know what you're doing.
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="wifi_ssid" class="form-label fw-bold">WiFi SSID</label>
                <input type="text" class="form-control" id="wifi_ssid" placeholder="Enter new SSID">
            </div>

            <div class="col-md-6 mb-3">
                <label for="wifi_password" class="form-label fw-bold">WiFi Password</label>
                <div class="input-group">
                    <input type="password" class="form-control" id="wifi_password" placeholder="Enter new password">
                    <button class="btn btn-outline-secondary" type="button" id="toggle-password">
                        <i class="bi bi-eye"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Status Messages -->
<div id="status-message" class="alert" style="display: none;"></div>

<script src="/static/js/settings.js"></script>

{% endblock %}
